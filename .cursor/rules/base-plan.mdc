---
appliesTo: ["plan"]
---

# MeepleOn 서버 - Plan 모드 기본 가이드라인

## 📋 플랜 생성 원칙

### 1. 구조적 접근
- **도메인 모델 우선**: 새 기능 추가 시 먼저 데이터 모델과 관계를 설계
- **3계층 구조 준수**: Routes → Controllers → Services → Repositories 순서로 계획
- **단계별 구현**: 각 레이어를 순차적으로 구현하도록 계획

### 2. 플랜 구성 요소
플랜에는 반드시 다음이 포함되어야 합니다:
1. **도메인/DB 설계 요약**: 테이블 구조, 관계, 인덱스
2. **파일 구조**: 생성/수정될 파일 목록과 경로
3. **구현 단계**: TODO 형태로 구체적인 작업 목록
4. **주의사항**: 환경변수, 마이그레이션, 테스트 등

### 3. MeepleOn 특화 규칙

#### 데이터베이스 설계
- MySQL 기준으로 명확한 관계 정의 (1:N, N:N)
- 외래키 제약조건 명시
- 인덱스 전략 포함 (검색 성능 고려)
- 마이그레이션 파일 생성 계획

#### API 설계
- RESTful 규칙 준수
- `/api/v1/...` prefix 사용
- camelCase 응답 형식
- 페이지네이션 고려 (기본: page + pageSize)

#### 인증/권한
- 소셜 로그인 (카카오) 기반
- JWT 토큰 사용
- 비로그인 열람 가능 여부 명시
- 역할 기반 접근 제어 (필요시)

### 4. 구현 우선순위

#### 필수 작업
1. 모델 타입 정의 (`src/models/`)
2. DB 스키마/마이그레이션 (`migrations/`)
3. Repository 레이어 (`src/repositories/`)
4. Service 레이어 (`src/services/`)
5. Controller 레이어 (`src/controllers/`)
6. Routes 정의 (`src/routes/`)
7. 라우터 등록 (`src/routes/index.ts`)

#### 선택 작업
- 미들웨어 추가 (필요시)
- 유틸리티 함수 (필요시)
- 에러 핸들링 개선 (필요시)

### 5. 코드 품질

#### 타입 안전성
- TypeScript 타입 명확히 정의
- `any` 타입 최소화
- MySQL2의 `RowDataPacket` 타입 적절히 사용

#### 에러 처리
- 커스텀 에러 클래스 활용 (`AppError` 상속)
- 적절한 HTTP 상태 코드
- 명확한 에러 메시지

#### 코드 스타일
- 코드/식별자: 영어
- 주석/설명: 한국어
- 파일명: camelCase 또는 kebab-case 일관성 유지

### 6. 테스트 고려사항

플랜에 다음을 포함:
- 환경변수 설정 필요 여부
- 데이터베이스 마이그레이션 필요 여부
- 테스트 데이터 준비 방법
- API 테스트 방법 (curl 예시 등)

### 7. 확장성 고려

- 향후 기능 확장 가능성 언급
- 성능 최적화 포인트 (인덱스, 쿼리 등)
- 캐싱 전략 (필요시)

## 🎯 플랜 작성 예시 구조

```markdown
# [기능명] 구현 계획

## 개요
- 목적과 범위 명시

## 도메인 설계
- 테이블 구조
- 관계 정의
- 인덱스 전략

## 파일 구조
- 생성할 파일 목록
- 수정할 파일 목록

## 구현 단계
1. [단계명] - [설명]
2. [단계명] - [설명]
...

## 주의사항
- 환경변수 설정
- 마이그레이션 실행
- 테스트 방법
```

## ⚠️ 플랜 생성 시 체크리스트

- [ ] 도메인 모델이 명확히 정의되었는가?
- [ ] DB 관계(1:N, N:N)가 명확한가?
- [ ] 3계층 구조를 따르는가?
- [ ] API 엔드포인트가 RESTful한가?
- [ ] 인증/권한 처리가 포함되었는가?
- [ ] 에러 처리가 계획되었는가?
- [ ] 마이그레이션 파일이 포함되었는가?
- [ ] 환경변수 설정이 필요한가?
- [ ] 테스트 방법이 명시되었는가?
